# RabbitMQ Production Environment Configuration
# Sources base configuration and overrides with Production-specific settings

# === Environment Info ===
ENVIRONMENT_NAME="prod"
ENVIRONMENT_TYPE="production"

# === Cluster Name (Environment Specific) ===
RABBITMQ_CLUSTER_NAME="rabbitmq-prod-cluster"

# === Node Configuration ===
RABBITMQ_NODE_1_HOSTNAME="prod-rmq-node1"
RABBITMQ_NODE_2_HOSTNAME="prod-rmq-node2"
RABBITMQ_NODE_3_HOSTNAME="prod-rmq-node3"

# === IP Addresses (Update with actual Production environment IPs) ===
RABBITMQ_NODE_1_IP="10.20.20.10"
RABBITMQ_NODE_2_IP="10.20.20.11"
RABBITMQ_NODE_3_IP="10.20.20.12"

# === Load Balancer Configuration ===
RABBITMQ_VIP="10.20.20.100"
HAPROXY_HOST="10.20.20.101"

# === SSL Certificate Paths ===
RABBITMQ_SSL_CACERT="$RABBITMQ_SSL_CERT_DIR/prod/ca_certificate.pem"
RABBITMQ_SSL_CERT="$RABBITMQ_SSL_CERT_DIR/prod/server_certificate.pem"
RABBITMQ_SSL_KEY="$RABBITMQ_SSL_CERT_DIR/prod/server_key.pem"

# === Production Performance Settings ===
RABBITMQ_VM_MEMORY_HIGH_WATERMARK="0.7"
RABBITMQ_DISK_FREE_LIMIT="5GB"

# === Production Monitoring ===
PROMETHEUS_PUSHGATEWAY="http://prod-prometheus-pushgateway:9091"
GRAFANA_URL="http://prod-grafana:3000"

# === Production Email Alerting ===
EMAIL_ALERTS="prod-oncall@company.com,ops-team@company.com,cto@company.com"
SLACK_WEBHOOK="https://hooks.slack.com/services/YOUR/PROD/WEBHOOK"

# === Production Database/External Dependencies ===
EXTERNAL_DB_HOST="prod-db.company.com"
EXTERNAL_API_ENDPOINT="https://api.company.com"

# === Node-specific Configuration for Production ===
# Node 1 (Primary)
RABBITMQ_NODE_1_DISK_FREE_LIMIT="5GB"
RABBITMQ_NODE_1_MEMORY_LIMIT="8GB"

# Node 2 (Secondary)
RABBITMQ_NODE_2_DISK_FREE_LIMIT="5GB"
RABBITMQ_NODE_2_MEMORY_LIMIT="8GB"

# Node 3 (Secondary)
RABBITMQ_NODE_3_DISK_FREE_LIMIT="5GB"
RABBITMQ_NODE_3_MEMORY_LIMIT="8GB"

# === Production Security ===
RABBITMQ_SSL_VERIFY="verify_peer"
RABBITMQ_SSL_FAIL_IF_NO_PEER_CERT="true"
RABBITMQ_HIPE_COMPILE="true"

# === Production-specific Features ===
RABBITMQ_ENABLE_FEATURE_FLAGS="stable"
RABBITMQ_DEBUG_MODE="false"

# === High Availability Configuration ===
RABBITMQ_CLUSTER_FORMATION_RETRY_DELAY="30"
RABBITMQ_CLUSTER_FORMATION_RETRY_LIMIT="10"

# === Production Backup Configuration ===
RABBITMQ_BACKUP_RETENTION_DAYS="30"
RABBITMQ_BACKUP_SCHEDULE="0 1 * * *"  # Daily at 1 AM
RABBITMQ_BACKUP_COMPRESS="true"
RABBITMQ_BACKUP_ENCRYPT="true"

# === Production Alerting Thresholds ===
ALERT_MEMORY_THRESHOLD="85"
ALERT_DISK_THRESHOLD="90"
ALERT_QUEUE_DEPTH_THRESHOLD="100000"
ALERT_CONNECTION_THRESHOLD="5000"

# === Production Log Configuration ===
RABBITMQ_LOG_LEVEL="info"
RABBITMQ_LOG_ROTATION="true"
RABBITMQ_LOG_RETENTION_DAYS="90"

# === Production Network Tuning ===
RABBITMQ_TCP_LISTEN_OPTIONS_BACKLOG="128"
RABBITMQ_TCP_LISTEN_OPTIONS_NODELAY="true"
RABBITMQ_HEARTBEAT="60"

# === PagerDuty Integration (Production Only) ===
PAGERDUTY_API_KEY="YOUR_PAGERDUTY_API_KEY"
ONCALL_PHONE="+1234567890"
# === Production Auto-Recovery Settings ===
RABBITMQ_FORCE_BOOT_ON_STARTUP="false"  # Conservative for data safety
RABBITMQ_AUTO_RECOVERY_DELAY="60"       # Longer delay for production
RABBITMQ_STARTUP_TIMEOUT="600"          # 10 minutes for production startup

# === Production Monitor Settings ===
RABBITMQ_MONITOR_CHECK_INTERVAL="30"    # More frequent checks in production
RABBITMQ_MONITOR_RECOVERY_TIMEOUT="600" # Longer recovery timeout
RABBITMQ_MONITOR_MAX_FAILURES="5"       # More failures before recovery
RABBITMQ_MONITOR_RECOVERY_COOLDOWN="3600" # 1 hour between recovery attempts
