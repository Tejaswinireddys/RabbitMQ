# RabbitMQ Staging Environment Configuration
# Sources base configuration and overrides with Staging-specific settings

# === Environment Info ===
ENVIRONMENT_NAME="staging"
ENVIRONMENT_TYPE="staging"

# === Cluster Name (Environment Specific) ===
RABBITMQ_CLUSTER_NAME="rabbitmq-staging-cluster"

# === Node Configuration ===
RABBITMQ_NODE_1_HOSTNAME="staging-rmq-node1"
RABBITMQ_NODE_2_HOSTNAME="staging-rmq-node2"
RABBITMQ_NODE_3_HOSTNAME="staging-rmq-node3"

# === IP Addresses (Update with actual Staging environment IPs) ===
RABBITMQ_NODE_1_IP="10.15.15.10"
RABBITMQ_NODE_2_IP="10.15.15.11"
RABBITMQ_NODE_3_IP="10.15.15.12"

# === Load Balancer Configuration ===
RABBITMQ_VIP="10.15.15.100"
HAPROXY_HOST="10.15.15.101"

# === SSL Certificate Paths ===
RABBITMQ_SSL_CACERT="$RABBITMQ_SSL_CERT_DIR/staging/ca_certificate.pem"
RABBITMQ_SSL_CERT="$RABBITMQ_SSL_CERT_DIR/staging/server_certificate.pem"
RABBITMQ_SSL_KEY="$RABBITMQ_SSL_CERT_DIR/staging/server_key.pem"

# === Staging Performance Settings (Production-like) ===
RABBITMQ_VM_MEMORY_HIGH_WATERMARK="0.65"
RABBITMQ_DISK_FREE_LIMIT="3GB"

# === Staging Monitoring ===
PROMETHEUS_PUSHGATEWAY="http://staging-prometheus-pushgateway:9091"
GRAFANA_URL="http://staging-grafana:3000"

# === Staging Email Alerting ===
EMAIL_ALERTS="staging-team@company.com,devops@company.com"
SLACK_WEBHOOK="https://hooks.slack.com/services/YOUR/STAGING/WEBHOOK"

# === Staging Database/External Dependencies ===
EXTERNAL_DB_HOST="staging-db.company.com"
EXTERNAL_API_ENDPOINT="https://staging-api.company.com"

# === Node-specific Configuration for Staging ===
# Node 1 (Primary)
RABBITMQ_NODE_1_DISK_FREE_LIMIT="3GB"
RABBITMQ_NODE_1_MEMORY_LIMIT="4GB"

# Node 2 (Secondary)
RABBITMQ_NODE_2_DISK_FREE_LIMIT="3GB"
RABBITMQ_NODE_2_MEMORY_LIMIT="4GB"

# Node 3 (Secondary)
RABBITMQ_NODE_3_DISK_FREE_LIMIT="3GB"
RABBITMQ_NODE_3_MEMORY_LIMIT="4GB"

# === Staging Security (Similar to Production) ===
RABBITMQ_SSL_VERIFY="verify_peer"
RABBITMQ_SSL_FAIL_IF_NO_PEER_CERT="true"

# === Staging-specific Features ===
RABBITMQ_ENABLE_FEATURE_FLAGS="all"  # Test new features in staging
RABBITMQ_DEBUG_MODE="false"

# === Staging Backup Configuration ===
RABBITMQ_BACKUP_RETENTION_DAYS="14"
RABBITMQ_BACKUP_SCHEDULE="0 3 * * *"  # Daily at 3 AM

# === Staging Log Configuration ===
RABBITMQ_LOG_LEVEL="info"
RABBITMQ_LOG_ROTATION="true"
RABBITMQ_LOG_RETENTION_DAYS="30"
# === Staging Auto-Recovery Settings ===
RABBITMQ_FORCE_BOOT_ON_STARTUP="false"  # Conservative like production
RABBITMQ_AUTO_RECOVERY_DELAY="30"       # Moderate delay
RABBITMQ_STARTUP_TIMEOUT="300"          # 5 minutes for staging startup

# === Staging Monitor Settings ===
RABBITMQ_MONITOR_CHECK_INTERVAL="45"    # Moderate frequency
RABBITMQ_MONITOR_RECOVERY_TIMEOUT="300" # Standard recovery timeout
RABBITMQ_MONITOR_MAX_FAILURES="3"       # Standard threshold
RABBITMQ_MONITOR_RECOVERY_COOLDOWN="900" # 15 minutes between attempts
